<!DOCTYPE html>
<html lang="en">
<head>
    <title>HTTP Live Streaming Overview: HTTP Streaming Architecture</title>
    <meta http-equiv="X-UA-Compatible" content="IE=7">
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta id="book-resource-type" name="book-resource-type" content="Guide">
    <script>String.prototype.cleanUpURL=function(){var c,b="",a=this;if(this.match("#")){b="#"+this.split("#")[1];a=this.split("#")[0]}a=a.replace(/\/\.\/|([^:])\/\//g,"$1/");if(a==="./"){return""+b}while(a!==c){c=a;a=a.replace(/[\/][^\/]+\/+\.\.\//,"/")}a=a.replace(/^.[^\/]+\/+\.\.\//,"");return a+b};(function(){var a="../../../../../";var c=window.location.pathname;var b=(c.slice(0,c.lastIndexOf("/"))+"/"+a).cleanUpURL();if(top.location.href==window.location.href){if("createTouch" in document){if(document.getElementById("book-resource-type").content!=="Standalone"){switch(navigator.platform){case"iPad":window.location.replace(a+"ipad/#"+c.replace(b,"")+window.location.hash);break;case"iPhone":break}}}else{window.location.replace(a+(window.location.protocol=="file:"?"index.html":"")+"#"+c.replace(b,"")+window.location.hash)}}})();</script>
    <meta scheme="apple_ref" id="identifier" name="identifier" content="//apple_ref/doc/uid/TP40008332">
    <meta id="date" name="date" content="2010-11-15">
    <meta id="description" name="description" content="Overview of live streaming over HTTP for iPhone.">
    <meta id="book-title" name="book-title" content="HTTP Live Streaming Overview">
    <meta id="book-root" name="book-root" content="../">
    <meta id="book-json" name="book-json" content="../book.json">
    <meta id="book-assignments" name="book-assignments" content="{Type/Guide}, {Topic/Networking & Internet}">
    <meta name="pdf" contents="../StreamingMediaGuide.pdf" /><link id="book-pdf" media="print" rel="alternate" type="application/pdf" href="../StreamingMediaGuide.pdf" />
    
    <meta id="generator" name="generator" content="Gutenberg 26027">
    <meta name='numbat' content='aa879094b666337fdcde744b62fbff30'>
    <meta id="copyright" name="copyright" content="Copyright 2010 Apple Inc. All Rights Reserved.">
    <meta name = "viewport" content = "width = device-width" >
    <meta id="xcode-display" name="xcode-display" content="render">
    <meta id="IndexTitle" name="IndexTitle" content="HTTP Streaming Architecture">
    <meta id="resources-uri" name="resources-uri" content="../../../../../Resources/541">
    <link id="book-index-page" rel="Start" title="HTTP Live Streaming Overview" type="text/html" href="../index.html">
    <link id="next-page" rel="Next" type="text/html" href="../UsingHTTPLiveStreaming/UsingHTTPLiveStreaming.html">
    <link id="previous-page" rel="Prev" type="text/html" href="../Introduction/Introduction.html">
    <link rel="stylesheet" type="text/css" href="../../../../../Resources/541/CSS/ac_media.css" charset="utf-8">
    <link rel="stylesheet" type="text/css" href="../../../../../Resources/541/CSS/devpubs.css" charset="utf-8">
    <link rel="stylesheet" type="text/css" href="../../../../../Resources/541/CSS/docs.css" charset="utf-8">
    <!--[if IE]><link rel="stylesheet" type="text/css" href="../../../../../Resources/541/CSS/ie.css"><![endif]-->
    
</head>    
<body><a name="//apple_ref/doc/uid/TP40008332-CH101" title="HTTP Streaming Architecture"></a>
    <article id="contents" tabindex="0" role="main">
        <!-- CONTENTS -->
        <div id="pageNavigationLinks_top" class="pageNavigationLinks">
            <a class='nextLink' rel='next' href='../UsingHTTPLiveStreaming/UsingHTTPLiveStreaming.html'>Next</a><a class='previousLink' rel='prev' href='../Introduction/Introduction.html'>Previous</a>
        </div>
        <a id="top" name="top"></a>
        <a id="INDEX" href="../index.html" style="display:none;"></a>
        
        <a name="//apple_ref/doc/uid/TP40008332-CH101-SW2" title="HTTP Streaming Architecture"></a><br /><h1 id="pageTitle">HTTP Streaming Architecture</h1><p>HTTP Live Streaming allows you to send live or prerecorded audio and video from an ordinary web server to any device running iOS 3.0 or later (including iPad), or any computer with QuickTime X or later installed, with support for encryption and authentication.</p><section><a name="//apple_ref/doc/uid/TP40008332-CH101-DontLinkElementID_1" title="Overview"></a><h2 class="jump">Overview</h2><p>Conceptually, HTTP Live Streaming consists of three parts: the server component, the distribution component, and the client software.  </p><p>The <strong>server component</strong> is responsible for taking input streams of media and encoding them digitally, encapsulating them in a format suitable for delivery, and preparing the encapsulated media for distribution.  </p><p>The <strong>distribution component</strong> consists of standard web servers. They are responsible for accepting client requests and delivering prepared media and associated resources to the client. For large-scale distribution, edge networks or other content delivery networks can also be used.</p><p>The <strong>client software</strong> is responsible for determining the appropriate media to request, downloading those resources, and then reassembling them so that the media can be presented to the user in a continuous stream. Client software is included on iOS 3.0 and later and computers with QuickTime X or later installed.</p><p>In a typical configuration, a hardware encoder takes audio-video input, encodes it as MPEG-4 audio and video, and outputs it in an MPEG-2 Transport Stream, which is then broken into a series of short media files by a software stream segmenter. These files are placed on a web server. The segmenter also creates and maintains an index file containing a list of the media files. The URL of the index file is published on the web server. Client software reads the index, then requests the listed media files in order and displays them without any pauses or gaps between segments.</p><p>An example of a simple HTTP streaming configuration is shown in <span class="content_text">“A basic configuration.”</span></p><figure><a name="//apple_ref/doc/uid/TP40008332-CH101-SW1" title="Figure 1-1A basic configuration"></a><figcaption><strong>Figure 1-1&nbsp;&nbsp;</strong>A basic configuration</figcaption><img src="../art/trasnsport_stream.jpg" alt="" width="627" height="386"></figure><p>Input can be live or from a prerecorded source. It is typically encoded into an MPEG-2 Transport Stream by off-the-shelf hardware. The MPEG2 stream is then broken into segments and saved as a series of one or more <code>.ts</code> media files. This is typically accomplished using a software tool such as the Apple stream segmenter. </p><p>Audio-only streams can be a series of MPEG elementary audio files formatted as either AAC with ADTS headers or MP3.</p><p>The segmenter also creates an index file. The index file contains a list of media files. The index file also contains metadata. The index file is in <code>.M3U8</code> format. The URL of the index file is accessed by clients, which then request the indexed files in sequence.</p></section><section><a name="//apple_ref/doc/uid/TP40008332-CH101-DontLinkElementID_2" title="Server Components"></a><h2 class="jump">Server Components</h2><p>The server requires a media encoder, which can be off-the-shelf hardware, and a way to break the encoded media into segments and save them as files, which can be software such as the media stream segmenter provided by Apple.</p><section><a name="//apple_ref/doc/uid/TP40008332-CH101-SW3" title="Media Encoder"></a><h3 class="jump">Media Encoder</h3><p>The media encoder takes a real-time signal from an audio-video device, encodes the media, and encapsulates it for transport.  Encoding should be set to a format supported by the client device, such as H.264 video and HE-AAC audio. Currently, the supported delivery format is MPEG-2 Transport Streams for audio-video, or MPEG elementary streams for audio-only.</p><p>The encoder delivers the encoded media in an MPEG-2 Transport Stream over the local network to the stream segmenter.</p><div class="notebox"><aside><a name="//apple_ref/doc/uid/TP40008332-CH101-DontLinkElementID_27" title="Note"></a><p><strong>Note:</strong>&nbsp;MPEG-2 transport streams should not be confused with MPEG-2 video compression. The transport stream is a packaging format that can be used with a number of different compression formats. Only MPEG-2 transport streams with H.264 video and AAC audio are supported at this time for audio-video content. Audio-only content can be either MPEG-2 transport or MPEG elementary audio streams, either in AAC format with ADTS headers or in MP3 format)  </p><p></p></aside></div><div class="importantbox clear"><aside><a name="//apple_ref/doc/uid/TP40008332-CH101-DontLinkElementID_28" title="Important:"></a><p><strong>Important:</strong>&nbsp;The video encoder should not change stream settings—such as video dimensions or codec type—in the midst of encoding a stream.</p><p></p></aside></div></section><section><a name="//apple_ref/doc/uid/TP40008332-CH101-DontLinkElementID_3" title="Stream Segmenter"></a><h3 class="jump">Stream Segmenter</h3><p>The stream segmenter is a process—typically software—that reads the Transport Stream from the local network and divides it into a series of small media files of equal duration. Even though each segment is in a separate file, video files are made from a continuous stream which can be reconstructed seamlessly.</p><p>The segmenter also creates an index file containing references to the individual media files. Each time the segmenter completes a new media file, the index file is updated.  The index is used to track the availability and location of the media files.  The segmenter may also encrypt each media segment and create a key file as part of the process.</p><p>Media segments are saved as <code>.ts</code> files (MPEG-2 streams) and index files are saved as <code>.M3U8</code> files, an extension of the <code>.m3u</code> format used for MP3 playlists.</p><div class="notebox"><aside><a name="//apple_ref/doc/uid/TP40008332-CH101-DontLinkElementID_29" title="Note"></a><p><strong>Note:</strong>&nbsp;Because the index file format is an extension of the <code>.m3u</code> file format, and because the system also supports <code>.mp3</code> audio media files, the client software may also be compatible with typical MP3 playlists used for streaming Internet radio.</p><p></p></aside></div><p>Here is a very simple example of an <code>.M3U8</code> file a segmenter might produce if the entire stream were contained in three unencrypted 10-second media files:</p><div class="codesample clear"><table><tr><td scope="row"><pre>#EXTM3U<span></span></pre></td></tr><tr><td scope="row"><pre>#EXT-X-MEDIA-SEQUENCE:0<span></span></pre></td></tr><tr><td scope="row"><pre>#EXT-X-TARGETDURATION:10<span></span></pre></td></tr><tr><td scope="row"><pre>#EXTINF:10,<span></span></pre></td></tr><tr><td scope="row"><pre>http://media.example.com/segment1.ts<span></span></pre></td></tr><tr><td scope="row"><pre>#EXTINF:10,<span></span></pre></td></tr><tr><td scope="row"><pre>http://media.example.com/segment2.ts<span></span></pre></td></tr><tr><td scope="row"><pre>#EXTINF:10,<span></span></pre></td></tr><tr><td scope="row"><pre>http://media.example.com/segment3.ts<span></span></pre></td></tr><tr><td scope="row"><pre>#EXT-X-ENDLIST<span></span></pre></td></tr></table></div><p>The index file may also contain URLs for encryption key files or alternate index files for different bandwidths. For details of the index file format, see the IETF Internet-Draft of the <span class="content_text"><a href="http://tools.ietf.org/html/draft-pantos-http-live-streaming" class="urlLink" rel="external">HTTP Live Streaming specification</a></span>.</p></section><section><a name="//apple_ref/doc/uid/TP40008332-CH101-DontLinkElementID_4" title="File Segmenter"></a><h3 class="jump">File Segmenter</h3><p>If you already have a media file encoded using supported codecs, you can use a file segmenter to encapsulate it in an MPEG stream and break it into segments of equal length (if the file is already encapsulated in an MPEG-2 transport stream, the file segmenter omits this step). The file segmenter allows you to use a library of existing audio and video files for video on demand via HTTP Live Streaming. It performs the same tasks as the media segmenter, but it takes files as input instead of streams.</p></section></section><section><a name="//apple_ref/doc/uid/TP40008332-CH101-DontLinkElementID_5" title="Media Segment Files"></a><h2 class="jump">Media Segment Files</h2><p>The media segment files are normally produced by the stream segmenter, based on input from the encoder, and consist of a series of <code>.ts</code> files containing segments of an MPEG-2 Transport Stream carrying H.264 video and AAC audio. For an audio-only broadcast, the segmenter can produce MPEG elementary audio streams containing either AAC audio with ADTS headers or MP3 audio. </p><p>Alternatively, it is possible to create the <code>.M3U8</code> file and the media segment files independently, provided they conform the published specification. For audio-only broadcasts, for example, you could create an <code>.M38U</code> file using a text editor, listing a series of existing <code>.MP3</code> files.</p></section><section><a name="//apple_ref/doc/uid/TP40008332-CH101-DontLinkElementID_6" title="Distribution Components"></a><h2 class="jump">Distribution Components</h2><p>The distribution system is a web server or a web caching system that delivers the media files and index files to the client over HTTP.  No custom server modules are required to deliver the content, and typically very little configuration is needed on the web server.  </p><p>Recommended configuration is typically limited to specifying MIME-type associations for <code>.M3U8</code> files and <code>.ts</code> files. </p><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><tr><td  scope="row"><p>File extension</p></td><td ><p>MIME type</p></td></tr><tr><td  scope="row"><p><code>.M3U8</code></p></td><td ><p>application/x-mpegURL or vnd.apple.mpegURL</p></td></tr><tr><td  scope="row"><p>.ts</p></td><td ><p>video/MP2T</p></td></tr></table></div><p>Tuning time-to-live (TTL) values for <code>.M3U8</code> files may also be necessary to achieve desired caching behavior for downstream web caches, as these files are frequently overwritten, and the latest version should be downloaded for each request.</p></section><section><a name="//apple_ref/doc/uid/TP40008332-CH101-DontLinkElementID_7" title="Client Component"></a><h2 class="jump">Client Component</h2><p>The client software begins by fetching the index file, based on a URL identifying the stream.  The index file in turn specifies the location of the available media files, decryption keys, and any alternate streams available.  For the selected stream, the client downloads each available media file in sequence. Each file contains a consecutive segment of the stream. Once it has a sufficient amount of data downloaded, the client begins presenting the reassembled stream to the user.</p><p>The client is responsible for fetching any decryption keys, authenticating or presenting a user interface to allow authentication, and decrypting media files as needed.</p><p>This process continues until the client encounters the <code>#EXT-X-ENDLIST</code> tag in the index file. If no <code>#EXT-X-ENDLIST</code> tag is encountered, the index file is part of an ongoing broadcast. The client loads a new version of the index file periodically. The client looks for new media files and encryption keys in the updated index and adds these URLs to its queue.</p></section>
        <div id="pageNavigationLinks_bottom" class="pageNavigationLinks">
            <a class='nextLink' rel='next' href='../UsingHTTPLiveStreaming/UsingHTTPLiveStreaming.html'>Next</a><a class='previousLink' rel='prev' href='../Introduction/Introduction.html'>Previous</a>
        </div><br/>
        <div class="copyright"><br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> &#x00a9; 2010 Apple Inc. All Rights Reserved. &#40;Last updated: 2010-11-15&#041;</p></div></div>

        <div id="feedbackForm" class="hideOnPrint" style="margin-left: auto; margin-right: auto; width: 38em; margin-bottom: 15px; margin-top: 15px; font-weight: bold; color: #333333; background: #d9d9d9; padding: 5px 10px 5px 10px; height: 15px; text-align: center; -webkit-border-radius: 12px; -moz-border-radius: 12px; vertical-align: middle;">
    Did this document help you?
    <span class="tooltip" data-abstract="<b>Yes:</b> Tell us what works for you.">
       <a href="http://developer.apple.com/feedback/?v=1&url=%2Flibrary%2Fios%2Fdocumentation%2FNetworkingInternet%2FConceptual%2FStreamingMediaGuide%2FHTTPStreamingArchitecture%2FHTTPStreamingArchitecture.html%3Fdocset%3Dcom.apple.adc.documentation.AppleiOS4_2.iOSLibrary-37.11%26id%3DTP40008332-2.0&media=xcode" class='urlLink'>Yes</a>
    </span>
    <span class="tooltip" data-abstract="<b>It's good, but:</b> Report typos, inaccuracies, and so forth.">
        <a href="http://developer.apple.com/feedback/?v=2&url=%2Flibrary%2Fios%2Fdocumentation%2FNetworkingInternet%2FConceptual%2FStreamingMediaGuide%2FHTTPStreamingArchitecture%2FHTTPStreamingArchitecture.html%3Fdocset%3Dcom.apple.adc.documentation.AppleiOS4_2.iOSLibrary-37.11%26id%3DTP40008332-2.0&media=xcode" class='urlLink'>It's good, but...</a>
    </span>
    <span class="tooltip" data-abstract="<b>Not helpful:</b> Tell us what would have helped.">
        <a href="http://developer.apple.com/feedback/?v=3&url=%2Flibrary%2Fios%2Fdocumentation%2FNetworkingInternet%2FConceptual%2FStreamingMediaGuide%2FHTTPStreamingArchitecture%2FHTTPStreamingArchitecture.html%3Fdocset%3Dcom.apple.adc.documentation.AppleiOS4_2.iOSLibrary-37.11%26id%3DTP40008332-2.0&media=xcode" class='urlLink'>Not helpful...</a>
    </span>
</div>
        
        <!-- /CONTENTS -->
    </article>
</body>
<script charset="utf-8" src="../../../../../Resources/541/JavaScript/lib/prototype.js"></script>
<!-- Media player includes -->
<script charset="utf-8" src="../../../../../Resources/541/JavaScript/lib/scriptaculous.js"></script>
<script charset="utf-8" src="../../../../../Resources/541/JavaScript/lib/event_mixins.js"></script>
<script charset="utf-8" src="../../../../../Resources/541/JavaScript/lib/browserdetect.js"></script>
<script charset="utf-8" src="../../../../../Resources/541/JavaScript/lib/ac_media.js"></script>
<!-- /Media player includes -->
<script charset="utf-8" src="../../../../../Resources/541/JavaScript/devpubs.js"></script>
<script charset="utf-8" src="../../../../../Resources/541/JavaScript/book.js"></script>
</html>